<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="true" MainGUID="E2656454-A6F7-4611-8C69-570E0EA58965" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="41">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>784EAEA1-5041-4AA6-B6F4-EF263A891EE7</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
lin_ 0,0,0, 1,0,0
]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
rect2 0,0, A,B

! Size hotspots

hotspot2  0,	 B, UnID, A, 1 + 128	: UnID = UnID + 1
hotspot2  A,	 B, UnID, A, 2			: UnID = UnID + 1
hotspot2 -1,	 B, UnID, A, 3			: UnID = UnID + 1

hotspot2  A,	 0, UnID, B, 1 + 128	: UnID = UnID + 1
hotspot2  A,	 B, UnID, B, 2			: UnID = UnID + 1
hotspot2  A,	-1, UnID, B, 3			: UnID = UnID + 1


hotspot2  0,	 0, UnID, A, 1 + 128	: UnID = UnID + 1
hotspot2  A,	 0, UnID, A, 2			: UnID = UnID + 1
hotspot2 -1,	 0, UnID, A, 3			: UnID = UnID + 1

hotspot2  0,	 0, UnID, B, 1 + 128	: UnID = UnID + 1
hotspot2  0,	 B, UnID, B, 2			: UnID = UnID + 1
hotspot2  0,	-1, UnID, B, 3			: UnID = UnID + 1


! Offset hotspots

for _i = 1 to vardim1(offsetPointS)
	hotspot2  offsetPointS[_i][_X_],	 0,						UnID, offsetPointS[_i][_Y_],1 + 128	: UnID = UnID + 1
	hotspot2  offsetPointS[_i][_X_],	 offsetPointS[_i][_Y_],	UnID, offsetPointS[_i][_Y_],2		: UnID = UnID + 1
	hotspot2  offsetPointS[_i][_X_],	-1,						UnID, offsetPointS[_i][_Y_],3		: UnID = UnID + 1

	hotspot2  0,						 offsetPointS[_i][_Y_], UnID, offsetPointS[_i][_X_],1 + 128	: UnID = UnID + 1
	hotspot2  offsetPointS[_i][_X_],	 offsetPointS[_i][_Y_],	UnID, offsetPointS[_i][_X_],2		: UnID = UnID + 1
	hotspot2 -1,						 offsetPointS[_i][_Y_],	UnID, offsetPointS[_i][_X_],3		: UnID = UnID + 1
next _i

add2 offsetPointS[1][_X_], offsetPointS[1][_Y_]
	rect2 0,0, offsetPointS[2][_X_] - offsetPointS[1][_X_], offsetPointS[2][_Y_] - offsetPointS[1][_Y_]
del 1


! Beam hotspots

for _i = 1 to vardim1(xPositionS)
	hotspot2  0,				 offsetPointS[1][_Y_],	UnID, xPositionS[_i],1 + 128: UnID = UnID + 1
	hotspot2  xPositionS[_i],	 offsetPointS[1][_Y_],	UnID, xPositionS[_i],2		: UnID = UnID + 1
	hotspot2 -1,				 offsetPointS[1][_Y_],	UnID, xPositionS[_i],3		: UnID = UnID + 1
next _i


! Hole hotspots

for _i = 2 to vardim1(holeDefS)
	for _j = 1 to 3 step 2
		__x = _j
		__y = _j + 1

		hotspot2  holeDefS[_i][__x],	 0,					UnID, holeDefS[_i][__y],1 + 128	: UnID = UnID + 1
		hotspot2  holeDefS[_i][__x],	 holeDefS[_i][__y],	UnID, holeDefS[_i][__y],2		: UnID = UnID + 1
		hotspot2  holeDefS[_i][__x],	-1,					UnID, holeDefS[_i][__y],3		: UnID = UnID + 1
	
		hotspot2  0,					 holeDefS[_i][__y], UnID, holeDefS[_i][__x],1 + 128	: UnID = UnID + 1
		hotspot2  holeDefS[_i][__x],	 holeDefS[_i][__y],	UnID, holeDefS[_i][__x],2		: UnID = UnID + 1
		hotspot2 -1,					 holeDefS[_i][__y],	UnID, holeDefS[_i][__x],3		: UnID = UnID + 1
	next _j

	rect2 holeDefS[_i][_XMIN], holeDefS[_i][_YMIN], holeDefS[_i][_XMAX], holeDefS[_i][_YMAX]
next _i

gosub "CalculateHoles"

for _i = 1 to vardim1(segmentS)
	line2 segmentS[_i][1],segmentS[_i][2], segmentS[_i][3], segmentS[_i][4] 
next _i

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
UnID = 1
EPS = 0.0001

_X_ = 1
_Y_ = 2
_Z_ = 3

_XMIN = 1
_YMIN = 2
_XMAX = 3
_YMAX = 4

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
goto "EndMaster"
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

"CalculateHoles":
	dim segmentS[][4]
	_s = 1
	
	for _i = 1 to vardim1(xPositionS)
		segmentS[_s][1] = xPositionS[_i]
		segmentS[_s][2] = offsetPointS[1][_Y_]
	
		dim cutterS[][2]
		_k = 1
	
		for _j = 1 to vardim1(holeDefS)
			if	holeDefS[_j][_XMIN] < xPositionS[_i]\
			&	holeDefS[_j][_XMAX] > xPositionS[_i]\
			then
				cutterS[_k][1] = holeDefS[_j][_YMIN]
				cutterS[_k][2] = holeDefS[_j][_YMAX]
	
				_k = _k + 1
			endif
	
			dim _temp[2]
	
			for _l = 1 to vardim1(cutterS)
				for _m = _l to vardim1(cutterS)
					if cutters[_l][1] > cutters[_m][1] then
						_temp = cutters[_l]
						cutters[_l] = cutters[_m]
						cutters[_m] = _temp
					endif
				next _m
			next _l
	
			for _l = 1 to vardim1(cutterS)
				segmentS[_s][3] = xPositionS[_i]
				segmentS[_s][4] = cutterS[_l][1]
	
				_s = _s + 1
	
				segmentS[_s][1] = xPositionS[_i]
				segmentS[_s][2] = cutterS[_l][2]
			next _l
		next _j
	
		segmentS[_s][3] = xPositionS[_i]
		segmentS[_s][4] = offsetPointS[2][_Y_]
	
		_s = _s + 1
	next _i
return

"EndMaster":
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
UI_DIALOG "LIMA Ceiling Generator"

UI_PAGE 1

UI_CURRENT_PAGE 1

yButton = 26
xSep = 5

UI_BUTTON UI_FUNCTION, "Hole+", xSep, xSep, 100, yButton, 100 ui_tooltip "Add a hole"
!UI_infield "iDivide",  xSep, xSep, 25, yButton

]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
dim _xPositionS[]

if	iDivide > EPS then
	_dist = (offsetPointS[2][_X_] - offsetPointS[1][_X_]) / iDivide

	for _i = 1 to iDivide - 1
		_xPositionS[_i] = offsetPointS[1][_X_] + _dist * _i
	next _i
	
	iDivide = 0

	parameters	iDivide = iDivide,
				xPositionS = _xPositionS
endif

if	iDeleteHole > 1 \
&	iDeleteHole <= vardim1(holeDefS)\
then
	dim _newHoleDefs[][4]

	_j = vardim1(holeDefS)

	for _i = _j to 1 step -1
		if _i <> iDeleteHole then
			_j = _j - 1

			_newHoleDefs[_j] = holeDefs[_i]
		endif
	next _i

	parameters	holeDefs	= _newHoleDefs,
				iDeletehole	= 0
endif

if 	GLOB_UI_BUTTON_ID = 100 then
	_iNew = vardim1(holeDefS)

	holeDefS[_iNew + 1][_XMIN] = -0.1
	holeDefS[_iNew + 1][_YMIN] = -0.1
	holeDefS[_iNew + 1][_XMAX] = -0.2
	holeDefS[_iNew + 1][_YMAX] = -0.2

	parameters holeDefS = holeDefS
endif
]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="27" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>0.6</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_2D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_2D_representation">
			<Description><![CDATA["2D Representation"]]></Description>
			<Fix/>
		</Title>
		<PenColor Name="gs_cont_pen">
			<Description><![CDATA["Contour Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<FillPattern Name="gs_fill_type">
			<Description><![CDATA["Fill Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_fill_pen">
			<Description><![CDATA["Fill Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>
		<PenColor Name="gs_back_pen">
			<Description><![CDATA["Fill Background Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>

		<!-- gs_list: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_list">
			<Description><![CDATA["Description"]]></Description>
			<Fix/>
		</Title>
		<RealNum Name="gs_list_cost">
			<Description><![CDATA["Cost"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="gs_list_manufacturer">
			<Description><![CDATA["Manufacturer"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_note">
			<Description><![CDATA["Note/Remarks"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_location">
			<Description><![CDATA["Location"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_accessories">
			<Description><![CDATA["Accessories"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_Type">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Others"]]></Value>
		</String>
		<Integer Name="iFMType">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>25</Value>
		</Integer>
		<String Name="FM_InventoryNumber">
			<Description><![CDATA["Inventory Number"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_SerialNumber">
			<Description><![CDATA["Serial Number"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_ProductionYear">
			<Description><![CDATA["Production Year"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<RealNum Name="FM_ObjectWeight">
			<Description><![CDATA["Object Weight"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="FM_ObjectWeightUnit">
			<Description><![CDATA["Object Weight Unit"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["kg"]]></Value>
		</String>
		<String Name="gs_list_custom1">
			<Description><![CDATA["User Defined 1"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom2">
			<Description><![CDATA["User Defined 2"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom3">
			<Description><![CDATA["User Defined 3"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom4">
			<Description><![CDATA["User Defined 4"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom5">
			<Description><![CDATA["User Defined 5"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>

		<!-- LIMA: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Length Name="LIMA">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="offsetPointS">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<ArrayValues FirstDimension="2" SecondDimension="2">
				<AVal Column="1" Row="1">0.1</AVal>
				<AVal Column="2" Row="1">0.1</AVal>
				<AVal Column="1" Row="2">0.5</AVal>
				<AVal Column="2" Row="2">0.9</AVal>
			</ArrayValues>
		</Length>
		<Length Name="xPositionS">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<ArrayValues FirstDimension="3" SecondDimension="0">
				<AVal Row="1">0</AVal>
				<AVal Row="2">0.2</AVal>
				<AVal Row="3">0.4</AVal>
			</ArrayValues>
		</Length>
		<Length Name="holeDefS">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<ArrayValues FirstDimension="2" SecondDimension="4">
				<AVal Column="1" Row="1">0</AVal>
				<AVal Column="2" Row="1">0</AVal>
				<AVal Column="3" Row="1">0</AVal>
				<AVal Column="4" Row="1">0</AVal>
				<AVal Column="1" Row="2">0.2</AVal>
				<AVal Column="2" Row="2">0.4</AVal>
				<AVal Column="3" Row="2">0.4</AVal>
				<AVal Column="4" Row="2">0.6</AVal>
			</ArrayValues>
		</Length>
		<Integer Name="iDivide">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="iDeleteHole">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC BY</Type>
		<Version>4.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>
